<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Connecting Arduino &amp; Phones with Bluetooth &amp; Cordova</title>

		<meta name="description" content="Connecting Arduino &amp; Phones with Bluetooth &amp; Cordova">
		<meta name="author" content="Don Coleman">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
        <!-- <link rel="stylesheet" href="css/theme/default.css" id="theme"> -->
		<link rel="stylesheet" href="css/theme/sky.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->


		<style>
		    .reveal pre {
              font-size: 1em;
		      width: 100%;
		    }

			.reveal h1,
			.reveal h2,
			.reveal h3,
			.reveal h4,
			.reveal h5,
			.reveal h6 {
/*			margin: 0 0 20px 0;
			color: #333333;
			font-family: "Quicksand", sans-serif;
			line-height: 0.9em;
			letter-spacing: -0.08em;
			text-transform: uppercase;
			text-shadow: none; */
			text-transform: none;
		    }
		</style>
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<h2>Connecting Arduino &amp; Phones with Bluetooth &amp; Cordova</h2>
					<p>Philly ETE - April 23, 2014</p>
					<p>
						<small>Presented by <a href="http://github.com/don">Don Coleman</a> / <a href="http://twitter.com/doncoleman">@doncoleman</a></small>
					</p>
				</section>

								<!-- TODO replace with a picture -->
								<section>
										<h2>Phone &lt;===&gt; Device</h2>
								</section>


                <section>
                    <h1>Bluetooth</h1>
                </section>

                <section>
                    <h2 style="text-transform: none;">Alternatives</h2>
                    <ul style="list-style-type: none;">
                        <li>WiFi</li>
                        <li>XBee ZigBee</li>
                        <li>ZWave</li>
                        <li>433 MHz</li>
                        <li>Other 2.4 GHz</li>
                    </ul>
                </section>

<!--                 <section>
                    <h1 style="text-transform: none;">Bluetooth</h1>
                    <h1 style="text-transform: none;">Classic</h1>
                </section>

                <section>
                    <h1 style="text-transform: none;">Bluetooth</h1>
                    <h1 style="text-transform: none;">Low Energy</h1>
                </section>

                <section>
                    <img src="images/LogoBluetoothSmart.jpg" /><br/>
                    <img src="images/LogoBluetoothSmartReady.jpg" />
                </section>

                <section>
                    <img width="100%" src="images/bluetoothEcosystem.png" />
                    <small><a href="http://www.bluetooth.com/Pages/Smart-Logos.aspx">http://www.bluetooth.com/Pages/Smart-Logos.aspx</a>
                </section></small>

                <section>
                    <!- - h1>Adopted Specifications</h1 - ->
                    <img src="images/adopted-specifications.png">
                    <small><a href="https://www.bluetooth.org/en-us/specification/adopted-specifications">https://www.bluetooth.org/en-us/specification/adopted-specifications</a></small>
                </section>

                <section>
                    <!- - h1>Definition Browser</h1 - ->
                    <img src="images/definition-browser.png" />
                    <small><a href="https://developer.bluetooth.org/gatt/Pages/Definition-Browser.aspx">https://developer.bluetooth.org/gatt/Pages/Definition-Browser.aspx</a></small>
                </section>

                <section>
                    <!- - h1>Definition</h1 - ->
                    <img src="images/heart-rate-service.png" />
                    <small><a href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.heart_rate.xml">https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.heart_rate.xml</a></small>

                </section>
-->

                <!-- -->
                
                <section>
                    <h2>Apache Cordova</h2>
                    <p class="fragment">PhoneGap</p>
                </section>
                    
                <section>
                    <h2>npm install -g cordova</h2>
                </section>

                <section>
                    <h2><a href="http://docs.cordova.io">http://docs.cordova.io</a></h2>
                </section>
                                
                <section>
                    <h1>Arduino</h1>
                </section>

                <section>
                    <img src="images/uno.jpg" />
                </section>

				<!-- TODO different hardware -->
                <section>
                    <img src="images/arduino-bluetooth.jpg" />
                </section>

                <section>
                    <img src="images/arduino-bluetooth-tx-rx.png" />
                </section>

                <section>
                    <img src="images/bluefruit-tx-rx.png" />
                </section>

                <section>
                    <img src="images/PhoneBluetoothArduino.png" />
                </section>


                <section>
                    <img src="images/arduino-ide.png"/>
                </section>

<!--                 <section>
                    <img src="images/software-serial.png"/>
                    <small><a href="http://arduino.cc/en/Reference/SoftwareSerialConstructor" alt="Arduino Docs">http://arduino.cc/en/Reference/SoftwareSerialConstructor</a></small>
                </section> -->


				<section>
					<pre><code>
  #include &lt;SoftwareSerial.h&gt;

  #define RxD 6
  #define TxD 7

  SoftwareSerial bluetooth(RxD,TxD);
  int counter = 0;
					</code></pre>
				</section>

<section>
	<pre><code>
  void setup() {
    Serial.begin(9600);
    bluetooth.begin(9600);
    Serial.println("Bluetooth Counter\n");
  }
	</code></pre>
</section>

<section>
	<pre><code>
  void loop() {
    Serial.println(counter);
    bluetooth.println(counter);
    counter++;
    delay(1000);
  }
	</code></pre>
</section>


<!--
                <section>
                    <img src="images/cordova_bot.png" style="border: none;"/>
                    <h2 style="text-transform: none;">PhoneGap</h2>
                    <h2 style="text-transform: none;">Apache Cordova</h>
                </section>

                <section>
                    <h2 style="text-transform: lowercase;">$ npm install cordova -g</h2>
                </section> -->

                <section>
                    <h2>Bluetooth Serial</h2>
					<h3>Cordova Plugin</h3>
                    <a href="https://github.com/don/BluetoothSerial">https://github.com/don/BluetoothSerial</a>
                    <aside class="notes">
                        Make a connection over bluetooth
                        Treat it like a serial port
                    </aside>
                </section>

                <section>
                    <h2>Installing</h2>
            		<pre><code language="bash">
  $ cordova plugin install \
        com.megster.cordova.bluetoothserial

                    </code></pre>
            	</section>

                <section>
                    <h2>Connecting</h2>
				    <pre><code>
  var macAddress = "00:00:AA:BB:CC:DD";

  bluetoothSerial.connect(
        macAddress,
        connected,
        disconnected);

                    </code></pre>
			    </section>

    			<section>
  				    <h2>Sending Data</h2>
  				    <pre><code>
    bluetoothSerial.write("Hello Arduino");
  				    </code></pre>
  				</section>


	            <section>
                    <h2>Receiving Data</h2>
				    <pre><code>
  var onMessage = function(data) {
      console.log(data);
  };

  bluetoothSerial.subscribe("\n",
            onMessage,
            onFailure);
                    </code></pre>
				</section>

				<section>
				    <section>
				        <h2>Demo</h2>
                        Phone receives data from Arduino
                    </section>
                    <section>
                        <img src="images/bluetooth-counter.png">
                    </section>
				</section>


<section>
	<h2>Listing Devices</h2>
	<pre><code>
  bluetoothSerial.list(success, failure);
	</code></pre>
</section>

<section>
	<h2>List shows paired devices</h2>
	<pre><code>[{
    "class": 276,
    "id": "10:BF:48:CB:00:00",
    "address": "10:BF:48:CB:00:00",
    "name": "Nexus 7"
}, {
    "class": 7936,
    "id": "00:06:66:4D:00:00",
    "address": "00:06:66:4D:00:00",
    "name": "RN42"
}]</code></pre>
</section>

<section>
	<h2>What about iOS?</h2>
	<!-- plugin started with Android -->
</section>

<section>
	<h2>Bluetooth Low Energy</h2>
	<p>aka Bluetooth Smart</p>
</section>

<section>
	<h2>BLE doesn't have SPP</h2>
	<p>but available hardware has "serial like" services</p>
</section>

<section>
	<h2>UART Service</h2>
		<ul>
			<li>RX - write without response</li> <!-- RX from radio perspective -->
    		<li>TX - read, notify</li> <!-- TX from radio perspective -->
		</ul>
</section>

<section>
	<h2>Discovering devices</h2>
	<pre><code>
  bluetoothSerial.list(success, failure);
	</code></pre>

	<p>No pairing, finds devices</p>
</section>

<section>
    <h2>List discovered devices</h2>
	<pre><code>[{
  "id": "CC410A23-2865-F03E-FC6A-4C17E858E11E",
  "uuid": "CC410A23-2865-F03E-FC6A-4C17E858E11E",
  "name": "Biscuit",
  "rssi": -68
},{
  "id": "ED7127D4-593B-490E-9DA7-959FE78EC603",
  "uuid": "ED7127D4-593B-490E-9DA7-959FE78EC603",
  "name": "UART",
  "rssi": -47
}]</code></pre>
</section>

<section>
	<h2>Once you're connected there's no difference</h2>
	<p>(except BLE only handles small chunks of data)</p>
</section>

<section>
	<h2>BLE hardware</h2>
	<ul>
	    <li><a href="http://redbearlab.com/blemini/">RedBearLab BLEmini</a></li>
	    <li><a href="http://redbearlab.com/bleshield/">RedBearLab BLE Shield</a></li>
	    <li><a href="http://adafru.it/1697">Adafruit Bluefruit LE</a></li>
	</ul>
</section>

<!--
<section>
	<h2>Need transition here</h2>
</section>
-->

				<section>
				    <h2 style="text-transform: lowercase;">c red, green, blue</h2>
				</section>

				<section>
				    <h2 style="text-transform: lowercase;">c0,0,255\n</h2>
				</section>

			    <section>
				    <section>
                        <h2>Demo</h2>
                        Phone controls LED strip on Arduino
                    </section>
                    <section>
                        Control NeoPixel LED on Arduino from Android
                        <img src="images/neopixel.jpg">
    				</section>
                </section>

				<section>
					<pre><code>
  onColorChange: function (evt) {
    var c = app.getColor();
    rgbText.innerText = c; // 0,0,255
    previewColor.style.backgroundColor =
        "rgb(" + c + ")";
    app.sendToArduino(c);
  },
					</code></pre>
				</section>

<section>
	<pre><code>
  sendToArduino: function(c) {
    bluetoothSerial.write("c" + c + "\n");
  },
	</code></pre>
</section>

<section>
	<pre><code language="c">  void loop() {

    if (bluetooth.find("c")) {
      red = bluetooth.parseInt();
      green = bluetooth.parseInt();
      blue = bluetooth.parseInt();
      showColor(red, green, blue);
    }
  }</code></pre>
</section>

<section>
    <img src="images/bluetoothlock_wiring_640.jpg" />
    <p><a href="http://makezine.com/projects/controlling-a-lock-with-an-arudino-and-bluetooth-le/">Bluetooth Low Energy Lock</a><p>
</section>
    
<section>
    <h2>BluetoothSerial Plugin</h2>
    <ul>
    <li class="fragment">Bluetooth Classic for Android</li>
    <li class="fragment">Bluetooth LE for iOS</li>
    <li class="fragment">List or discover devices</li>
    <li class="fragment">Connect to a peripheral</li>
    <li class="fragment">Write to send data</li>
    <li class="fragment">Subscribe to read data</li>
    </ul>
</section>

<section>
		<img src="images/rfduino.jpg">
		<a href="http://rfduino.com">http://rfduino.com</a>
</section>

<section>
    <h2>RFduino Cordova Plugin</h3>
    <a href="https://github.com/don/corodva-plugin-rfduino">https://github.com/don/corodva-plugin-rfduino</a>
</section>

<section>
    <pre><code>
rfduino.discover(seconds, success, failure);

</code></pre>

    <pre class="fragment"><code>
{
  "name": "RFduino",
  "uuid": "BD922605-1B07-4D55-8D09-B66653E51BBA",
  "advertising": "echo",
  "rssi": -79
}
    </code></pre>

</section>

<section>
  <pre><code>
  rfduino.connect(uuid, success, failure);
  </code></pre>

</section>

<section>
  <pre><code>
  rfduino.write("hello", success, failure);
  </code></pre>
</section>

<section>
  <pre><code>
  rfduino.onData(success, failure);
  </code></pre>
</section>

<section>
    <pre><code>
  var onData = function(arrayBuffer) {
    var a = new Float32Array(arrayBuffer);
    celsius = a[0];
    fahrenheit = celsius * 1.8 + 32;
  }
    </code></pre>
    <!-- http://updates.html5rocks.com/2012/06/How-to-convert-ArrayBuffer-to-and-from-String -->
</section>

<section>
<img src="images/rfduino-temperature.png">
</section>

<section>
    <h2>RFduino Plugin</h2>
    <ul>
    <li class="fragment">Bluetooth LE for iOS and Android</li>
    <li class="fragment">Discover devices</li>
    <li class="fragment">Connect to a peripheral</li>
    <li class="fragment">Write to send data</li>
    <li class="fragment">Subscribe to read data</li>
    </ul>
</section>

<section>
    <h2>Future</h2>
</section>

<!-- wish this had a better API, recommend with reservations -->
<section>
	<h3>BluetoothLE</h3>
	<a href="https://github.com/randdusing/BluetoothLE">https://github.com/randdusing/BluetoothLE</a>
</section>


                <section>
                    <ul style="list-style-type: none;">
                        <li><a href="http://cordova.io">Cordova</a></li>                        
                        <li><a href="http://arduino.cc">Arduino</a></li>
                        <li><a href="http://redbearlab.com/blemini/">RedBearLab BLEmini</a></li>
						<li><a href="http://www.adafruit.com/products/1588">Adafruit Bluefruit EZ-Link</a></li>
						<li><a href="http://www.adafruit.com/products/1697">Adafruit Bluefruit LE</a></li>
						<li><a href="http://www.adafruit.com/products/1138">Adafruit NeoPixel LED</a></li>
						<li><a href="http://rfduino.com">RFduino</a></li>
                        <li><a href="http://github.com/don/BluetoothSerial">Bluetooth Serial Cordova Plugin</a></li>
                        <li><a href="http://github.com/don/cordova-plugin-rfduino">RFduino Cordova Plugin</a></li>
                        <li><a href="https://github.com/hakimel/reveal.js">Reveal.js (for slides)</a> </li>
                    </ul>
                   <br/>
                </section>

                <section>
                    <h2>Thank You</h2>
                    <p>Don Coleman</p>
                    <p><a href="http://twitter.com/doncoleman">@doncoleman</a></p>
                    <p>
                        <a href="mailto:&#100;&#111;&#110;&#0064;&#99;&#104;&#97;&#114;&#105;&#111;&#116;&#115;&#111;&#108;&#117;&#116;&#105;&#111;&#110;&#115;.&#99;&#111;&#109;">&#100;&#111;&#110;&#0064;&#99;&#104;&#97;&#114;&#105;&#111;&#116;&#115;&#111;&#108;&#117;&#116;&#105;&#111;&#110;&#115;.&#99;&#111;&#109;</a>
                    </p>
                    <p>
                    <a href="http://don.github.io/slides/">
                        http://don.github.io/slides/</a>
                    </p>
                    <!-- should be using css -->
                    <p>&nbsp;</p>
                    <p>&nbsp;</p>
                    <p>
                        <small>
                    <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Connecting Arduino &amp; Phones with Bluetooth &amp; Cordova</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://don.github.io/slides/2014-04-23-phillyete-bluetooth" property="cc:attributionName" rel="cc:attributionURL">Don Coleman</a> <br/>is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/don/slides/tree/gh-pages/2014-04-23-phillyete-bluetooth" rel="dct:source">https://github.com/don/.../2014-04-23-phillyete-bluetooth</a>.
                        </small>
                    </p>
                </section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
